os: windows
language: node_js
node_js:
  - node

env:
  global:
    - "GIT_REPO_SLUG=dullage/tahskr"
    - "VERSION_BUMP_MESSAGE_PREFIX='Travis CI: Bump version to'"
# secret:
#   - DEPLOY_HOST_IP
#   - encrypted_7df0bf92a043_iv
#   - encrypted_7df0bf92a043_key
#   - GITHUB_TOKEN
#   - DEPLOY_TARGET_DIR

if: (tag IS blank AND commit_message !~ env(VERSION_BUMP_MESSAGE_PREFIX)) OR (tag IS present)

install: skip

script:
  - echo Skipping Build...
  # - npm ci
  # - npm run build
  # - npm run package-win

#before_deploy: 7z a tahskr.zip $TRAVIS_BUILD_DIR/builds/tahskr-win32-ia32/*
before_deploy: 7z a tahskr.zip $TRAVIS_BUILD_DIR/*

deploy:
  - provider: script
    skip_cleanup: true
    script: bash $TRAVIS_BUILD_DIR/.travis/bump_version.sh
    on:
      branch: feature/travis-builds
      tags: false
  # - provider: script
  #   skip_cleanup: true
  #   script: bash $TRAVIS_BUILD_DIR/.travis/deploy.sh
  #   on:
  #     branch: feature/travis-builds
  #     tags: true
  - provider: releases
    api_key:
      secure: "aQs+yzySdtGstaqZ+hLDOcsS0vxj0EDJ+nTqP+G1Ef3GldNbE1CyFBN04F7wLatTTuHKggykd2HZg8tIxBImY6kn/pm1rXyEq+sb93e/VH9mku6XklwiTyFNGNY0Y0HFpHsdZHGdKyF/GFVG/QbubJ2McnbEnOyWDB2BQ7McHPFvU8LoLbgl7hI0Ojv9Tjgc8LqgsSiNXMvZ9Qjhytn44TWSAAzcV2MsLzbHOkcJzCLZTCmitSIq+y7LT/SZ6TazUUr9+3ILrlZxaZvVtS5T5V3GoCO4g2FI25ooLog/dktxSsXRgy1se8VieXoqbl3kixMWCMwQc+UNJkge5NuSJQcvGoMI2TZUjm0VpESRcPyAGldsSl5TKGfhq4KpiEph1KuLy5cKf05bc8I8MDiP5Xxw63pDiGnj/0OMi9xp0hJ+C+Y1zuyEMVJ6VWBI5Ru+JM+dSKwbD1J1N797I6txkC8ruOQA+zr/h/N0OpZEZVxNPDHhqLS9bU75LDCRKvjVV5tSyIHZKrXGfQ4qG55cwmywedWpP7/JORxR9yDeSlKPEztV0YwY/pte5kgVEr5kESMUmjZ++v5pGTgyJnQ8ewQuWWkfoADsI0F1FiFZjUHeg0r3CdgiG8MV3dJyP8Y8eR2RBl0iplcuhBF/c61LPvkkFjiDLhuKZrqMiZND6Sg="
    file: tahskr.zip
    skip_cleanup: true
    on:
      branch: feature/travis-builds
      tags: true
